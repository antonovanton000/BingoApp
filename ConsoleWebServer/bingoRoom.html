<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>BingoApp Web</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <style>
        :root {
            --PrimaryColor: #414B4D;
            --PrimaryLight: #4D6774;
            --PrimaryDark: #363E40;
            --TextAndIconsBrush: #FFFFFF;
            --AccentBrush: #53749d;
            --AccentBrushDisabled: #6a7685;
            --PrimaryText: #bdc1c6;
            --PrimaryTextBrushDarker: #65686b;
            --SecondaryTextBrush: #000000;
            --DividerBrush: #76B43C;
            --BackgroundColor: #202124;
            --BorderColor: #3c4043;
        }

        .gradient-background-brush {
            background: linear-gradient(to bottom, #202124 0%, #111114 100%);
        }

        .bingo-color-orrange {
            background: linear-gradient(to bottom, #FF9C12 0%, #F98E1E 50%, #D0800F 100%);
        }

        .bingo-color-red {
            background: linear-gradient(to bottom, #FF4944 0%, #DA4440 50%, #CE302C 100%);
        }

        .bingo-color-blue {
            background: linear-gradient(to bottom, #409CFF 0%, #37A1DE 50%, #088CBD 100%);
        }

        .bingo-color-green {
            background: linear-gradient(to bottom, #31D814 0%, #00B500 50%, #20A00A 100%);
        }

        .bingo-color-purple {
            background: linear-gradient(to bottom, #822dbf 0%, #7120ab 100%);
        }

        .bingo-color-navy {
            background: linear-gradient(to bottom, #0d48b5 0%, #022b75 100%);
        }

        .bingo-color-teal {
            background: linear-gradient(to bottom, #419695 0%, #2e7372 100%);
        }

        .bingo-color-brown {
            background: linear-gradient(to bottom, #ab5c23 0%, #6d3811 100%);
        }

        .bingo-color-pink {
            background: linear-gradient(to bottom, #ed86aa 0%, #cc6e8f 100%);
        }

        .bingo-color-yellow {
            background: linear-gradient(to bottom, #d8d014 0%, #c1ba0b 100%);
        }


        body {
            background-color: var(--BackgroundColor);
            color: var(--PrimaryText);
            padding-top: 20px;
        }

        .bingo-board {
        }

        .bingo-row {
            display: flex;
        }

        .second-color {
            transform: skew(-0.78rad) translateX(59%) scale(1.2);
        }

        .square[data-colors="3"] .second-color {
            transform: skew(-0.78rad) translateX(33%) scale(1.2);
        }

        .third-color {
            transform: skew(-0.78rad) translateX(93%) scale(1.2);
        }

        .square {
            flex-basis: 20%;
            flex-grow: 0;
            flex-shrink: 0;
            aspect-ratio: 1 / 1;
            background-color: #000;
            border: 1px solid var(--BorderColor);
            border-radius: 8%;
            position: relative;
            font-size: 100%;
            text-align: center;
            cursor: pointer;
            overflow: hidden;
            color: white;
        }

            .square .bg-color {
                width: 100%;
                height: 100%;
                border-radius: 8%;
                position: absolute;
            }

        .bingo-row .square:hover {
            background-color: #0A0A0A;
        }

        .vertical-center {
            left: 5px;
            right: 5px;
            position: absolute;
            top: 50%;
            z-index: 500;
            cursor: pointer;
            transform: translateY(-50%);
            -webkit-transform: translateY(-50%);
            -moz-transform: translateY(-50%);
        }

        .chatFeed {
            border: 1px solid var(--BorderColor);
            border-radius: 10px;
            padding: 10px;
            height: 100%;
            background: var(--BackgroundColor);
            min-height: 46vh;
        }

        .feed-item{
            background-color:rgba(255,255,255,0.05);
            padding:10px;
            border-radius:0px 8px 8px 0px;
            border-left:5px solid var(--AccentBrush);
            margin-bottom:10px;
            position:relative;
        }

        .feed-item-timestamp {
            position: absolute;
            top: 8px;
            right: 8px;
            font-size: 14px;
            color: var(--AccentBrush);
        }

        @media only screen and (max-device-width: 480px) { /* smartphones, portrait iPhone, portrait 480x320 phones (Android) */
            .square {
                font-size: 140%;
            }

            .feed-item-timestamp {
                font-size: 24px;
            }

            .feed-item-header {
                font-size: 42px;
            }

            .feed-item-message {
                font-size: 35px;
            }
        }      

    </style>
</head>
<body class="gradient-background-brush vh-100">
    <div class="container-lg">
        
        <div class="row">
            <div class="col-lg-6 col-12">
                <div class="row mb-lg-3 mb-5">
                    <div class="col-12">
                        <h2 id="roomName">Room Name</h2>
                    </div>
                </div>
                <div class="bingo-board">
                    <div class="bingo-row">
                        <div class="square" id="slot1">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot2">
                            <!--<div class="bg-color bingo-color-red"></div>
                    <div class="bg-color bingo-color-blue second-color"></div>
                    <div class="bg-color bingo-color-green third-color"></div>-->
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot3">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot4">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot5">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                    </div>
                    <div class="bingo-row">
                        <div class="square" id="slot6">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot7">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot8">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot9">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot10">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                    </div>
                    <div class="bingo-row">
                        <div class="square" id="slot11">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot12">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot13">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot14">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot15">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                    </div>
                    <div class="bingo-row">
                        <div class="square" id="slot16">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot17">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot18">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot19">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot20">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                    </div>
                    <div class="bingo-row">
                        <div class="square" id="slot21">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot22">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot23">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot24">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                        <div class="square" id="slot25">
                            <div class="vertical-center text-container">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 col-12 mt-lg-0 mt-5">
                <div class="row mb-lg-3 mb-4">
                    <div class="col-12">
                        <h2>Feed</h2>
                    </div>
                </div>
                <div class="chatFeed">
                    <div class="feed-item">
                        <h4 class="feed-item-header">Header</h4>
                        <p class="feed-item-message">Message</p>
                        <span class="feed-item-timestamp">11:53:52</span>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@microsoft/signalr@7.0.5/dist/browser/signalr.min.js"></script>
    <script>
        const connection = new signalR.HubConnectionBuilder()
            .withUrl("/bingoHub")
            .build();

        var room = {};

        connection.on("RecieveRoomInfo", function (json) {
            room = JSON.parse(json);
            document.getElementById('roomName').innerHTML = room.RoomName;
            for (var i in room.Board.Squares) {
                var square = room.Board.Squares[i];

                var squareElement = document.querySelector(`#${square.Slot}`);
                var textElement = document.querySelector(`#${square.Slot} .text-container`);
                textElement.innerHTML = square.Name;

                const filtered = square.SquareColors.filter(x => x !== 10);
                var marksCount = filtered.length;
                squareElement.setAttribute("data-colors", marksCount);

                if (marksCount > 0) {
                    // Удалить все элементы с классом bg-color внутри #slot1
                    squareElement.querySelectorAll('.bg-color').forEach(el => el.remove());
                    for (var j in filtered) {
                        var colorIndex = filtered[j];
                        var bingoColor = getBingoColorByNumber(colorIndex);
                        // Добавить новый div с классом bg-color bingo-color-red
                        const newDiv = document.createElement('div');
                        newDiv.className = 'bg-color';
                        newDiv.classList.add(bingoColor);
                        if (j == 1)
                            newDiv.classList.add("second-color");

                        if (j == 2)
                            newDiv.classList.add("third-color");

                        squareElement.appendChild(newDiv);
                    }
                }

            }
        });

        connection.start().then(function () {
            // Пример отправки сообщения

            connection.invoke("InitRoom");

        }).catch(function (err) {
            return console.error(err.toString());
        });

        function getBingoColorByNumber(number) {
            switch (number) {
                case 0:
                    return "bingo-color-orange"
                case 1:
                    return "bingo-color-red"
                case 2:
                    return "bingo-color-blue"
                case 3:
                    return "bingo-color-green"
                case 4:
                    return "bingo-color-purple"
                case 5:
                    return "bingo-color-navy"
                case 6:
                    return "bingo-color-teal"
                case 7:
                    return "bingo-color-brown"
                case 8:
                    return "bingo-color-pink"
                case 9:
                    return "bingo-color-yellow"
                case 10:
                    return ""
            }
        }
    </script>

</body>
</html>