@using System.Globalization
@using SocketServer.Models
@model SocketServer.Controllers.BingoPlayer
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    var title = "";
    var leaderBoardItems = ViewBag.LeaderBoards as List<LeaderboardItem>;
    var hpleaderBoardItems = ViewBag.HPLeaderBoards as List<LeaderboardItem>;
    var gamesResults = ViewBag.GamesResults as List<GameResult>;
    var hpgamesResults = ViewBag.HPGamesResults as List<HPGameResult>;

    var sekiroItems = leaderBoardItems.Where(i => (i.GameName ?? "").ToLower().Contains("sekiro")).OrderByDescending(i => i.WinsCount).ToList();
    var minecraftItems = leaderBoardItems.Where(i => (i.GameName ?? "").ToLower().Contains("minecraft")).OrderByDescending(i => i.WinsCount).ToList();
    var otherItems = leaderBoardItems.Where(i => (!(i.GameName ?? "").ToLower().Contains("sekiro")) && (!(i.GameName ?? "").ToLower().Contains("minecraft"))).OrderByDescending(i => i.WinsCount).ToList();
    var nightreignItems = hpleaderBoardItems.Where(i => (i.GameName ?? "").ToLower().Contains("nightreign")).OrderByDescending(i => i.WinsCount).ToList();


    var sekiroResults = gamesResults.Where(i => (i.GameName ?? "").ToLower().Contains("sekiro")).ToList();
    var minecraftResults = gamesResults.Where(i => (i.GameName ?? "").ToLower().Contains("minecraft")).ToList();
    var otherResults = gamesResults.Where(i => (!(i.GameName ?? "").ToLower().Contains("sekiro")) && (!(i.GameName ?? "").ToLower().Contains("minecraft"))).ToList();
    var nightreignResults = hpgamesResults.Where(i => (i.GameName ?? "").ToLower().Contains("nightreign")).ToList();
}

<div class="breadcrumbs">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6 offset-lg-3 col-md-12 col-12">
                <div class="breadcrumbs-content">
                    <h1 class="page-title" data-i18n="l-leaderboard">Результаты игр</h1>
                    <ul class="breadcrumb-nav">
                        <li><a href="/" data-i18n="l-main">Главная</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- End Breadcrumbs -->


<div class="contact-us section">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="col-lg-8 col-12 m-auto">
                    <ul class="nav nav-pills nav-success mb-3" role="tablist">
                        <li class="nav-item waves-effect waves-light" role="presentation">
                            <a class="nav-link active" data-bs-toggle="tab" href="#bingo" role="tab" aria-selected="true" data-i18n="lb-bingo">Бинго</a>
                        </li>
                        <li class="nav-item waves-effect waves-light" role="presentation">
                            <a class="nav-link" data-bs-toggle="tab" href="#huntpoint" role="tab" aria-selected="false" tabindex="-1">Huntpoint</a>
                        </li>
                    </ul>
                </div>
                <div class="tab-content text-muted">
                    @* BINGO *@
                    <div class="tab-pane active py-3" id="bingo" role="tabpanel">
                        <div class="row">
                            <div class="col-lg-8 col-12 m-auto">
                                <ul class="nav nav-pills nav-success mb-3" role="tablist">
                                    <li class="nav-item waves-effect waves-light" role="presentation">
                                        <a class="nav-link active" data-bs-toggle="tab" href="#home-1" role="tab" aria-selected="true">Sekiro: Shadows Die Twice</a>
                                    </li>                                    
                                    <li class="nav-item waves-effect waves-light" role="presentation">
                                        <a class="nav-link" data-bs-toggle="tab" href="#profile-1" role="tab" aria-selected="false" tabindex="-1">Minecraft</a>
                                    </li>
                                    <li class="nav-item waves-effect waves-light" role="presentation">
                                        <a class="nav-link" data-bs-toggle="tab" href="#messages-1" role="tab" aria-selected="false" tabindex="-1" data-i18n="lb-othergames">Другие игры</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="tab-content text-muted">
                            <div class="tab-pane active" id="home-1" role="tabpanel">
                                @if (sekiroResults.Count > 0)
                                {
                                    <div class="row">
                                        <div class="col-lg-8 col-12 m-auto">
                                            <div id="header">
                                                <h1 data-i18n="lb-leaderboard">Список лидеров</h1>
                                            </div>
                                            <div class="table-header">
                                                <table id="headertable">
                                                    <thead>
                                                        <tr>
                                                            <td style="width:10%">#</td>
                                                            <td style="width:50%" data-i18n="lb-player">Игрок</td>
                                                            <td style="width:20%" data-i18n="lb-games">Игры</td>
                                                            <td style="width:20%" data-i18n="lb-wins">Победы</td>
                                                        </tr>
                                                    </thead>
                                                </table>
                                            </div>
                                            <div id="leaderboard">
                                                <div class="ribbon"></div>
                                                <table>
                                                    <tbody>
                                                        @for (int i = 0; i < sekiroItems.Count; i++)
                                                        {
                                                            <tr>
                                                                <td style="width:10%" class="number">@(i + 1)</td>
                                                                <td style="width:50%" class="name">@sekiroItems[i].PlayerName</td>
                                                                <td style="width:20%;" class="games">@sekiroItems[i].GamesCount</td>
                                                                <td style="width:20%;" class="points">
                                                                    @sekiroItems[i].WinsCount
                                                                    @if (i == 0)
                                                                    {
                                                                        <img class="gold-medal" src="https://github.com/malunaridev/Challenges-iCodeThis/blob/master/4-leaderboard/assets/gold-medal.png?raw=true" alt="gold medal" />
                                                                    }
                                                                </td>
                                                            </tr>

                                                        }
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <hr />
                                    <div class="row">
                                        <div class="col-12">
                                            <h4 class="mt-4 mb-4" data-i18n="lb-results">Результаты игр</h4>
                                        </div>
                                    </div>
                                    <div class="row">
                                        @foreach (var item in sekiroResults.OrderByDescending(i => i.GameDate))
                                        {
                                            <div class="col-lg-4 col-md-4 col-12">
                                                <!-- Start Single Blog Grid -->
                                                <div class="single-blog-grid">
                                                    <div class="blog-img">
                                                        <img src="~/assets/images/apps/gameresult_sekiro.png" alt="#" />
                                                        <div class="img-overlay">
                                                            <h4>@(item.PlayersNames.ElementAtOrDefault(0))</h4>
                                                            <h4>vs</h4>
                                                            <h4>@(item.PlayersNames.ElementAtOrDefault(1))</h4>
                                                            @if (item.PlayersNames.Length > 2)
                                                            {
                                                                <h4>vs</h4>
                                                                <h4>@(item.PlayersNames.ElementAtOrDefault(2))</h4>
                                                            }
                                                        </div>
                                                    </div>
                                                    <div class="blog-content">
                                                        <div class="meta-info">
                                                            <a class="date" href="javascript:void(0)">
                                                                <i class="lni lni-timer"></i>
                                                                @item.GameDate.ToString("dd.MM.yyyy HH:mm", CultureInfo.GetCultureInfo("ru-RU"))
                                                            </a>
                                                            <a class="author" href="javascript:void(0)">
                                                                @item.BingoType
                                                            </a>
                                                        </div>
                                                        <div class="score-panel d-flex flex-row justify-content-center gap-2">
                                                            <h2>@item.Score.ElementAtOrDefault(0)<span>(@item.LinesCount.ElementAtOrDefault(0))</span></h2>
                                                            <h2>:</h2>
                                                            <h2>@item.Score.ElementAtOrDefault(1)<span>(@item.LinesCount.ElementAtOrDefault(1))</span></h2>
                                                            @if (item.PlayersNames.Length > 2)
                                                            {
                                                                <h2>:</h2>
                                                                <h2>@item.Score.ElementAtOrDefault(2)<span>(@item.LinesCount.ElementAtOrDefault(2))</span></h2>
                                                            }
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- End Single Blog Grid -->
                                            </div>
                                        }
                                    </div>
                                }
                                else
                                {
                                    <div class="d-flex flex-row align-items-center justify-content-center">
                                        <p class="text-center py-5" data-i18n="lb-noresults">Здесь пока нет результатов...</p>
                                    </div>
                                }
                            
                            </div>
                            <div class="tab-pane" id="profile-1" role="tabpanel">
                                @if (minecraftResults.Count > 0)
                                {
                                    <div class="row">
                                        <div class="col-lg-8 col-12 m-auto">
                                            <div id="header">
                                                <h1 data-i18n="lb-leaderboard">Список лидеров</h1>
                                            </div>
                                            <div class="table-header">
                                                <table id="headertable">
                                                    <thead>
                                                        <tr>
                                                            <td style="width:10%">#</td>
                                                            <td style="width:50%" data-i18n="lb-player">Игрок</td>
                                                            <td style="width:20%" data-i18n="lb-games">Игры</td>
                                                            <td style="width:20%" data-i18n="lb-wins">Победы</td>
                                                        </tr>
                                                    </thead>
                                                </table>
                                            </div>
                                            <div id="leaderboard">
                                                <div class="ribbon"></div>
                                                <table>
                                                    <tbody>
                                                        @for (int i = 0; i < minecraftItems.Count; i++)
                                                        {
                                                            <tr>
                                                                <td style="width:10%" class="number">@(i + 1)</td>
                                                                <td style="width:50%" class="name">@minecraftItems[i].PlayerName</td>
                                                                <td style="width:20%;" class="games">@minecraftItems[i].GamesCount</td>
                                                                <td style="width:20%;" class="points">
                                                                    @minecraftItems[i].WinsCount
                                                                    @if (i == 0)
                                                                    {
                                                                        <img class="gold-medal" src="https://github.com/malunaridev/Challenges-iCodeThis/blob/master/4-leaderboard/assets/gold-medal.png?raw=true" alt="gold medal" />
                                                                    }
                                                                </td>
                                                            </tr>

                                                        }
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <hr />
                                    <div class="row">
                                        <div class="col-12">
                                            <h4 class="mt-4 mb-4" data-i18n="lb-results">Результаты игр</h4>
                                        </div>
                                    </div>
                                    <div class="row">
                                        @foreach (var item in minecraftResults.OrderByDescending(i => i.GameDate))
                                        {
                                            <div class="col-lg-4 col-md-4 col-12">
                                                <!-- Start Single Blog Grid -->
                                                <div class="single-blog-grid">
                                                    <div class="blog-img">
                                                        <img src="~/assets/images/apps/gameresult_minecraft.png" alt="#" />
                                                        <div class="img-overlay">
                                                            <h4>@(item.PlayersNames.ElementAtOrDefault(0))</h4>
                                                            <h4>vs</h4>
                                                            <h4>@(item.PlayersNames.ElementAtOrDefault(1))</h4>
                                                            @if (item.PlayersNames.Length > 2)
                                                            {
                                                                <h4>vs</h4>
                                                                <h4>@(item.PlayersNames.ElementAtOrDefault(2))</h4>
                                                            }
                                                        </div>
                                                    </div>
                                                    <div class="blog-content">
                                                        <div class="meta-info">
                                                            <a class="date" href="javascript:void(0)">
                                                                <i class="lni lni-timer"></i>
                                                                @item.GameDate.ToString("dd.MM.yyyy HH:mm", CultureInfo.GetCultureInfo("ru-RU"))
                                                            </a>
                                                            <a class="author" href="javascript:void(0)">
                                                                @item.BingoType
                                                            </a>
                                                        </div>
                                                        <div class="score-panel d-flex flex-row justify-content-center gap-2">
                                                            <h2>@item.Score.ElementAtOrDefault(0)<span>(@item.LinesCount.ElementAtOrDefault(0))</span></h2>
                                                            <h2>:</h2>
                                                            <h2>@item.Score.ElementAtOrDefault(1)<span>(@item.LinesCount.ElementAtOrDefault(1))</span></h2>
                                                            @if (item.PlayersNames.Length > 2)
                                                            {
                                                                <h2>:</h2>
                                                                <h2>@item.Score.ElementAtOrDefault(2)<span>(@item.LinesCount.ElementAtOrDefault(2))</span></h2>
                                                            }
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- End Single Blog Grid -->
                                            </div>
                                        }
                                    </div>
                                }
                                else
                                {
                                    <div class="d-flex flex-row align-items-center justify-content-center">
                                        <p class="text-center py-5" data-i18n="lb-noresults">Здесь пока нет результатов...</p>
                                    </div>
                                }

                            </div>
                            <div class="tab-pane" id="messages-1" role="tabpanel">
                                @if (otherResults.Count > 0)
                                {
                                    <div class="row">
                                        <div class="col-lg-8 col-12 m-auto">
                                            <div id="header">
                                                <h1 data-i18n="lb-leaderboard">Список лидеров</h1>
                                            </div>
                                            <div class="table-header">
                                                <table id="headertable">
                                                    <thead>
                                                        <tr>
                                                            <td style="width:10%">#</td>
                                                            <td style="width:50%" data-i18n="lb-player">Игрок</td>
                                                            <td style="width:20%" data-i18n="lb-games">Игры</td>
                                                            <td style="width:20%" data-i18n="lb-wins">Победы</td>
                                                        </tr>
                                                    </thead>
                                                </table>
                                            </div>
                                            <div id="leaderboard">
                                                <div class="ribbon"></div>
                                                <table>
                                                    <tbody>
                                                        @for (int i = 0; i < otherItems.Count; i++)
                                                        {
                                                            <tr>
                                                                <td style="width:10%" class="number">@(i + 1)</td>
                                                                <td style="width:50%" class="name">@otherItems[i].PlayerName</td>
                                                                <td style="width:20%;" class="games">@otherItems[i].GamesCount</td>
                                                                <td style="width:20%;" class="points">
                                                                    @otherItems[i].WinsCount
                                                                    @if (i == 0)
                                                                    {
                                                                        <img class="gold-medal" src="https://github.com/malunaridev/Challenges-iCodeThis/blob/master/4-leaderboard/assets/gold-medal.png?raw=true" alt="gold medal" />
                                                                    }
                                                                </td>
                                                            </tr>

                                                        }
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <hr />
                                    <div class="row">
                                        <div class="col-12">
                                            <h4 class="mt-4 mb-4" data-i18n="lb-results">Результаты игр</h4>
                                        </div>
                                    </div>
                                    <div class="row">
                                        @foreach (var item in otherResults.OrderByDescending(i => i.GameDate))
                                        {
                                            <div class="col-lg-4 col-md-4 col-12">
                                                <!-- Start Single Blog Grid -->
                                                <div class="single-blog-grid">
                                                    <div class="blog-img">
                                                        <img src="~/assets/images/apps/gameresult_other.png" alt="#" />
                                                        <div class="img-overlay">
                                                            <h4>@(item.PlayersNames.ElementAtOrDefault(0))</h4>
                                                            <h4>vs</h4>
                                                            <h4>@(item.PlayersNames.ElementAtOrDefault(1))</h4>
                                                            @if (item.PlayersNames.Length > 2)
                                                            {
                                                                <h4>vs</h4>
                                                                <h4>@(item.PlayersNames.ElementAtOrDefault(2))</h4>
                                                            }
                                                        </div>
                                                    </div>
                                                    <div class="blog-content">
                                                        <div class="meta-info">
                                                            <a class="date" href="javascript:void(0)">
                                                                <i class="lni lni-timer"></i>
                                                                @item.GameDate.ToString("dd.MM.yyyy HH:mm", CultureInfo.GetCultureInfo("ru-RU"))
                                                            </a>
                                                            <a class="author" href="javascript:void(0)">
                                                                @item.BingoType
                                                            </a>
                                                        </div>
                                                        <div class="score-panel d-flex flex-row justify-content-center gap-2">
                                                            <h2>@item.Score.ElementAtOrDefault(0)<span>(@item.LinesCount.ElementAtOrDefault(0))</span></h2>
                                                            <h2>:</h2>
                                                            <h2>@item.Score.ElementAtOrDefault(1)<span>(@item.LinesCount.ElementAtOrDefault(1))</span></h2>
                                                            @if (item.PlayersNames.Length > 2)
                                                            {
                                                                <h2>:</h2>
                                                                <h2>@item.Score.ElementAtOrDefault(2)<span>(@item.LinesCount.ElementAtOrDefault(2))</span></h2>
                                                            }
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- End Single Blog Grid -->
                                            </div>
                                        }
                                    </div>
                                }
                                else
                                {
                                    <div class="d-flex flex-row align-items-center justify-content-center">
                                        <p class="text-center py-5" data-i18n="lb-noresults">Здесь пока нет результатов...</p>
                                    </div>
                                }

                            </div>
                        </div>
                    </div>
                    @* HUNTPOINT *@
                    <div class="tab-pane py-3" id="huntpoint" role="tabpanel">
                        <div class="row">
                            <div class="col-lg-8 col-12 m-auto">
                                <ul class="nav nav-pills nav-success mb-3" role="tablist">                                    
                                    <li class="nav-item waves-effect waves-light" role="presentation">
                                        <a class="nav-link active" data-bs-toggle="tab" href="#nightreign" role="tab" aria-selected="true">Elden Ring Nightreign</a>
                                    </li>                                    
                                </ul>
                            </div>
                        </div>
                        <div class="tab-content text-muted">
                            <div class="tab-pane active" id="nightreign" role="tabpanel">
                                @if (nightreignResults.Count > 0)
                                {
                                    <div class="row">
                                        <div class="col-lg-8 col-12 m-auto">
                                            <div id="header">
                                                <h1 data-i18n="lb-leaderboard">Список лидеров</h1>
                                            </div>
                                            <div class="table-header">
                                                <table id="headertable">
                                                    <thead>
                                                        <tr>
                                                            <td style="width:10%">#</td>
                                                            <td style="width:50%" data-i18n="lb-player">Игрок</td>
                                                            <td style="width:20%" data-i18n="lb-games">Игры</td>
                                                            <td style="width:20%" data-i18n="lb-wins">Победы</td>
                                                        </tr>
                                                    </thead>
                                                </table>
                                            </div>
                                            <div id="leaderboard">
                                                <div class="ribbon"></div>
                                                <table>
                                                    <tbody>
                                                        @for (int i = 0; i < nightreignItems.Count; i++)
                                                        {
                                                            <tr>
                                                                <td style="width:10%" class="number">@(i + 1)</td>
                                                                <td style="width:50%" class="name">@nightreignItems[i].PlayerName</td>
                                                                <td style="width:20%;" class="games">@nightreignItems[i].GamesCount</td>
                                                                <td style="width:20%;" class="points">
                                                                    @nightreignItems[i].WinsCount
                                                                    @if (i == 0)
                                                                    {
                                                                        <img class="gold-medal" src="https://github.com/malunaridev/Challenges-iCodeThis/blob/master/4-leaderboard/assets/gold-medal.png?raw=true" alt="gold medal" />
                                                                    }
                                                                </td>
                                                            </tr>

                                                        }
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <hr />
                                    <div class="row">
                                        <div class="col-12">
                                            <h4 class="mt-4 mb-4" data-i18n="lb-results">Результаты игр</h4>
                                        </div>
                                    </div>
                                    <div class="row">
                                        @foreach (var item in nightreignResults.OrderByDescending(i => i.GameDate))
                                        {
                                            <div class="col-lg-4 col-md-4 col-12">
                                                <!-- Start Single Blog Grid -->
                                                <div class="single-blog-grid">
                                                    <div class="blog-img">
                                                        <img src="~/assets/images/apps/gameresult_nightreign.png" alt="#" />
                                                        <div class="img-overlay">
                                                            <h4>@(item.PlayersNames.ElementAtOrDefault(0))</h4>
                                                            <h4>vs</h4>
                                                            <h4>@(item.PlayersNames.ElementAtOrDefault(1))</h4>
                                                            @if (item.PlayersNames.Length > 2)
                                                            {
                                                                <h4>vs</h4>
                                                                <h4>@(item.PlayersNames.ElementAtOrDefault(2))</h4>
                                                            }
                                                        </div>
                                                    </div>
                                                    <div class="blog-content">
                                                        <div class="meta-info">
                                                            <a class="date" href="javascript:void(0)">
                                                                <i class="lni lni-timer"></i>
                                                                @item.GameDate.ToString("dd.MM.yyyy HH:mm", CultureInfo.GetCultureInfo("ru-RU"))
                                                            </a>                                                            
                                                        </div>
                                                        <div class="score-panel d-flex flex-row justify-content-center gap-2">
                                                            <h2>@item.Score.ElementAtOrDefault(0)</h2>
                                                            <h2>:</h2>
                                                            <h2>@item.Score.ElementAtOrDefault(1)</h2>
                                                            @if (item.PlayersNames.Length > 2)
                                                            {
                                                                <h2>:</h2>
                                                                <h2>@item.Score.ElementAtOrDefault(2)</h2>
                                                            }
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- End Single Blog Grid -->
                                            </div>
                                        }
                                    </div>
                                }
                                else
                                {
                                    <div class="d-flex flex-row align-items-center justify-content-center">
                                        <p class="text-center py-5" data-i18n="lb-noresults">Здесь пока нет результатов...</p>
                                    </div>
                                }
                            </div>                            
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Styles {
    <link href="~/assets/css/leaderboard.css" rel="stylesheet" />
}

@section Scripts
{
    <script src="~/assets/js/leaderboard.js"></script>
}